<!DOCTYPE html>
<html lang="en-GB">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width">
    <link rel="alternate" type="text/markdown" href="date.rb.md">
    <style>
      body {
        max-width: 40rem;
        margin: auto;
        padding: 2rem 1rem;
        font-family: 'Helvetica Neue','Helvetica', system-ui;
        color: black;
        background-color: white;
      }
      p {line-height: 1.4;}
      code {
      line-height: 1.4;
      color:gray;
      }
      code pre {white-space: pre-wrap; word-break: break-word;}
      code:hover {color:black;}
      h1, h2 {font-weight:normal;}
      a {text-decoration:none;}
      a.githubline {color:gray;font-weight:bold;}
      @media (prefers-color-scheme: dark) {
body {color:white;background-color:black;}
a {text-decoration:underline;color:white;}
}
    </style>
    <title>./lib/monkey_patching/date.rb</title>
  </head>
  <body><h1>A monkey patched Ruby date class to handle UK Parliament specific day types.</h1>
<code title='Line 3, ./lib/monkey_patching/date.rb'><pre><a name='3'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L3'> 3</a> class Date
</pre></code><h2>A set of methods to work out the type of a given day.</h2>
<h3>We want to check if this is an actual sitting day in the Commons.</h3>
<p>We use a naive definition of a sitting day: this includes a calendar day when the Commons sits, together with following calendar days if the Commons sat through the night.</p>
<p>For example: if the Commons sat on a Tuesday and continued to sit overnight into Wednesday, both Tuesday and Wednesday would count as actual sitting days. </p>
<p>If the Tuesday sitting lasted long enough to overlap the starting time of the Wednesday sitting, the Tuesday would be a parliamentary sitting day, but the Wednesday would not.</p>
<code title='Line 15, ./lib/monkey_patching/date.rb'><pre><a name='15'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L15'> 15</a>   def is_commons_actual_sitting_day?
</pre></code><code title='Line 16, ./lib/monkey_patching/date.rb'><pre><a name='16'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L16'> 16</a>     SittingDay.all.where( 'start_date <= ?',  self ).where( 'end_date >= ?',  self ).where( house_id: 1 ).first
</pre></code><code title='Line 17, ./lib/monkey_patching/date.rb'><pre><a name='17'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L17'> 17</a>   end
</pre></code><h3>We want to check if this is an actual sitting day in the Lords.</h3>
<p>We use a naive definition of a sitting day: this includes a calendar day when the Lords sits, together with following calendar days if the Lords sat through the night.</p>
<p>For example: if the Lords sat on a Tuesday and continued to sit overnight into Wednesday, both Tuesday and Wednesday would count as actual sitting days.</p>
<p>If the Tuesday sitting lasted long enough to overlap the starting time of the Wednesday sitting, the Tuesday would be a parliamentary sitting day, but the Wednesday would not.</p>
<code title='Line 27, ./lib/monkey_patching/date.rb'><pre><a name='27'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L27'> 27</a>   def is_lords_actual_sitting_day?
</pre></code><code title='Line 28, ./lib/monkey_patching/date.rb'><pre><a name='28'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L28'> 28</a>     SittingDay.all.where( 'start_date <= ?',  self ).where( 'end_date >= ?',  self ).where( house_id: 2 ).first
</pre></code><code title='Line 29, ./lib/monkey_patching/date.rb'><pre><a name='29'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L29'> 29</a>   end
</pre></code><h3>We want to check if this is a parliamentary sitting day in the Commons.</h3>
<p>We use a more strict definition of a sitting day. We don’t include dates for which the Commons continued sitting from a previous day, where the preceding day’s sitting overlapped with the next day’s programmed sitting.</p>
<code title='Line 35, ./lib/monkey_patching/date.rb'><pre><a name='35'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L35'> 35</a>   def is_commons_parliamentary_sitting_day?
</pre></code><code title='Line 36, ./lib/monkey_patching/date.rb'><pre><a name='36'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L36'> 36</a>     SittingDay.all.where( 'start_date = ?',  self ).where( house_id: 1 ).first
</pre></code><code title='Line 37, ./lib/monkey_patching/date.rb'><pre><a name='37'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L37'> 37</a>   end
</pre></code><h3>We want to check if this is a parliamentary sitting day in the Lords.</h3>
<p>We use a more strict definition of a sitting day. We don’t include dates for which the Lords continued sitting from a previous day, where the preceding day’s sitting overlapped with the next day’s programmed sitting.</p>
<code title='Line 43, ./lib/monkey_patching/date.rb'><pre><a name='43'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L43'> 43</a>   def is_lords_parliamentary_sitting_day?
</pre></code><code title='Line 44, ./lib/monkey_patching/date.rb'><pre><a name='44'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L44'> 44</a>     SittingDay.all.where( 'start_date = ?',  self ).where( house_id: 2 ).first
</pre></code><code title='Line 45, ./lib/monkey_patching/date.rb'><pre><a name='45'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L45'> 45</a>   end
</pre></code><h3>We want to check if this is a virtual sitting day in the Commons.</h3>
<p>This is a day where all Members of the House sit ‘digitally’, rather than physically.</p>
<p>A virtual sitting may continue over more than one calendar day. We count any continuation, where the preceding day’s sitting overlapped with the next day’s programmed sitting, as also being a virtual sitting day.</p>
<p>As of the end of June 2020, the Commons has had no virtual sitting days.</p>
<code title='Line 55, ./lib/monkey_patching/date.rb'><pre><a name='55'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L55'> 55</a>   def is_commons_virtual_sitting_day?
</pre></code><code title='Line 56, ./lib/monkey_patching/date.rb'><pre><a name='56'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L56'> 56</a>     VirtualSittingDay.all.where( 'start_date <= ?',  self ).where( 'end_date >= ?',  self ).where( house_id: 1 ).first
</pre></code><code title='Line 57, ./lib/monkey_patching/date.rb'><pre><a name='57'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L57'> 57</a>   end
</pre></code><h3>We want to check if this is a virtual sitting day in the Lords.</h3>
<p>This is a day where all Members of the House sit ‘digitally’, rather than physically.</p>
<p>A virtual sitting may continue over more than one calendar day. We count any continuation, where the preceding day’s sitting overlapped with the next day’s programmed sitting, as also being a virtual sitting day.</p>
<code title='Line 65, ./lib/monkey_patching/date.rb'><pre><a name='65'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L65'> 65</a>   def is_lords_virtual_sitting_day?
</pre></code><code title='Line 66, ./lib/monkey_patching/date.rb'><pre><a name='66'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L66'> 66</a>     VirtualSittingDay.all.where( 'start_date <= ?',  self ).where( 'end_date >= ?',  self ).where( house_id: 2 ).first
</pre></code><code title='Line 67, ./lib/monkey_patching/date.rb'><pre><a name='67'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L67'> 67</a>   end
</pre></code><h3>We want to check if this is an actual sitting day in <em>either</em> House.</h3>
<code title='Line 71, ./lib/monkey_patching/date.rb'><pre><a name='71'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L71'> 71</a>   def is_either_house_actual_sitting_day?
</pre></code><code title='Line 72, ./lib/monkey_patching/date.rb'><pre><a name='72'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L72'> 72</a>     self.is_commons_actual_sitting_day? or self.is_lords_actual_sitting_day?
</pre></code><code title='Line 73, ./lib/monkey_patching/date.rb'><pre><a name='73'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L73'> 73</a>   end
</pre></code><h3>We want to check if this is an actual sitting day in <em>both</em> Houses.</h3>
<code title='Line 77, ./lib/monkey_patching/date.rb'><pre><a name='77'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L77'> 77</a>   def is_joint_actual_sitting_day?
</pre></code><code title='Line 78, ./lib/monkey_patching/date.rb'><pre><a name='78'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L78'> 78</a>     self.is_commons_actual_sitting_day? and self.is_lords_actual_sitting_day?
</pre></code><code title='Line 79, ./lib/monkey_patching/date.rb'><pre><a name='79'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L79'> 79</a>   end
</pre></code><h3>We want to check if this is a parliamentary sitting day in <em>either</em> House.</h3>
<code title='Line 83, ./lib/monkey_patching/date.rb'><pre><a name='83'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L83'> 83</a>   def is_either_house_parliamentary_sitting_day?
</pre></code><code title='Line 84, ./lib/monkey_patching/date.rb'><pre><a name='84'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L84'> 84</a>     self.is_commons_parliamentary_sitting_day? or self.is_lords_parliamentary_sitting_day?
</pre></code><code title='Line 85, ./lib/monkey_patching/date.rb'><pre><a name='85'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L85'> 85</a>   end
</pre></code><h3>We want to check if this is a parliamentary sitting day in <em>both</em> Houses.</h3>
<code title='Line 89, ./lib/monkey_patching/date.rb'><pre><a name='89'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L89'> 89</a>   def is_joint_parliamentary_sitting_day?
</pre></code><code title='Line 90, ./lib/monkey_patching/date.rb'><pre><a name='90'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L90'> 90</a>     self.is_commons_parliamentary_sitting_day? and self.is_lords_parliamentary_sitting_day?
</pre></code><code title='Line 91, ./lib/monkey_patching/date.rb'><pre><a name='91'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L91'> 91</a>   end
</pre></code><h3>We want to check if this is an adjournment day in either House.</h3>
<code title='Line 95, ./lib/monkey_patching/date.rb'><pre><a name='95'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L95'> 95</a>   def is_adjournment_day?
</pre></code><code title='Line 96, ./lib/monkey_patching/date.rb'><pre><a name='96'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L96'> 96</a>     AdjournmentDay.all.where( 'date = ?',  self ).first
</pre></code><code title='Line 97, ./lib/monkey_patching/date.rb'><pre><a name='97'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L97'> 97</a>   end
</pre></code><h3>We want to check if this is an adjournment day in the Commons.</h3>
<code title='Line 101, ./lib/monkey_patching/date.rb'><pre><a name='101'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L101'> 101</a>   def is_commons_adjournment_day?
</pre></code><code title='Line 102, ./lib/monkey_patching/date.rb'><pre><a name='102'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L102'> 102</a>     AdjournmentDay.all.where( 'date = ?',  self ).where( house_id: 1 ).first
</pre></code><code title='Line 103, ./lib/monkey_patching/date.rb'><pre><a name='103'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L103'> 103</a>   end
</pre></code><h3>We want to check if this is an adjournment day in the Lords.</h3>
<code title='Line 107, ./lib/monkey_patching/date.rb'><pre><a name='107'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L107'> 107</a>   def is_lords_adjournment_day?
</pre></code><code title='Line 108, ./lib/monkey_patching/date.rb'><pre><a name='108'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L108'> 108</a>     AdjournmentDay.all.where( 'date = ?',  self ).where( house_id: 2 ).first
</pre></code><code title='Line 109, ./lib/monkey_patching/date.rb'><pre><a name='109'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L109'> 109</a>   end
</pre></code><h3>We want to check if Parliament is prorogued on this day.</h3>
<code title='Line 113, ./lib/monkey_patching/date.rb'><pre><a name='113'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L113'> 113</a>   def is_prorogation_day?
</pre></code><code title='Line 114, ./lib/monkey_patching/date.rb'><pre><a name='114'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L114'> 114</a>     ProrogationDay.all.where( 'date = ?',  self ).first
</pre></code><code title='Line 115, ./lib/monkey_patching/date.rb'><pre><a name='115'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L115'> 115</a>   end
</pre></code><h3>We want to check if Parliament is dissolved on this day.</h3>
<code title='Line 119, ./lib/monkey_patching/date.rb'><pre><a name='119'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L119'> 119</a>   def is_dissolution_day?
</pre></code><code title='Line 120, ./lib/monkey_patching/date.rb'><pre><a name='120'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L120'> 120</a>     DissolutionDay.all.where( 'date = ?',  self ).first
</pre></code><code title='Line 121, ./lib/monkey_patching/date.rb'><pre><a name='121'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L121'> 121</a>   end
</pre></code><h3>We want to check if this is a day for which we have something in the calendar.</h3>
<p>That may be an actual sitting day - including parliamentary sitting days, a virtual sitting day, an adjournment day, a day within prorogation or a day within dissolution.</p>
<code title='Line 127, ./lib/monkey_patching/date.rb'><pre><a name='127'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L127'> 127</a>   def is_calendar_populated?
</pre></code><code title='Line 128, ./lib/monkey_patching/date.rb'><pre><a name='128'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L128'> 128</a>     self.is_commons_actual_sitting_day? or self.is_lords_actual_sitting_day? or self.is_commons_virtual_sitting_day? or self.is_lords_virtual_sitting_day? or self.is_adjournment_day? or self.is_prorogation_day? or self.is_dissolution_day?
</pre></code><code title='Line 129, ./lib/monkey_patching/date.rb'><pre><a name='129'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L129'> 129</a>   end
</pre></code><h3>We want to check if this is a day for which we do not have anything in the calendar.</h3>
<p>We use this to check if we&#39;ve <q>run out of calendar</q> so we don&#39;t keep cycling into future days and loop infinitely.</p>
<p>This is our event horizon.</p>
<code title='Line 137, ./lib/monkey_patching/date.rb'><pre><a name='137'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L137'> 137</a>   def is_calendar_not_populated?
</pre></code><code title='Line 138, ./lib/monkey_patching/date.rb'><pre><a name='138'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L138'> 138</a>     !self.is_calendar_populated?
</pre></code><code title='Line 139, ./lib/monkey_patching/date.rb'><pre><a name='139'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L139'> 139</a>   end
</pre></code><h3>Methods to calculate non-sitting scrutiny days in both Houses.</h3>
<p>In <a href="https://committees.parliament.uk/publications/688/documents/33426/default/">guidance issued on 16-04-2020</a> the Lords Procedure Committee stated, <q>A Virtual Proceeding is not a sitting of the House.</q></p>
<p>Whilst clerks state that a virtual sitting day does not count as a sitting day for the purposes of calculating scrutiny periods, lawyers imply this would need to be tested in court.</p>
<p>Unless and until this is resolved, these methods use the clerks&#39; definition of non-sitting scrutiny day.</p>
<h3>We want to check if this is a non-sitting scrutiny day in the Commons.</h3>
<p>During a short adjournment, adjournment days count toward the scrutiny period.</p>
<p>This method allows the definition of a “short” adjournment to be adjusted by passing in a maximum day count.</p>
<p>In all known cases “short” is defined as not more than four days.</p>
<p>For the purposes of calculating non-sitting scrutiny days, virtual sitting days also count.</p>
<code title='Line 159, ./lib/monkey_patching/date.rb'><pre><a name='159'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L159'> 159</a>   def is_commons_non_sitting_scrutiny_day?( maximum_day_count )
</pre></code><h4>We want to check if this is a Commons adjournnment day or a Commons virtual sitting day.</h4>
<code title='Line 163, ./lib/monkey_patching/date.rb'><pre><a name='163'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L163'> 163</a>     if self.is_commons_adjournment_day? or self.is_commons_virtual_sitting_day?
</pre></code><p>Having found that this is a Commons adjournnment day or a Commons virtual sitting day, we start the adjournment day count at 1.</p>
<code title='Line 167, ./lib/monkey_patching/date.rb'><pre><a name='167'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L167'> 167</a>       non_sitting_scrutiny_day_count = 1
</pre></code><p>We want to cycle through the following days until we reach the maximum day count passed into this function.</p>
<code title='Line 171, ./lib/monkey_patching/date.rb'><pre><a name='171'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L171'> 171</a>       date = self
</pre></code><code title='Line 172, ./lib/monkey_patching/date.rb'><pre><a name='172'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L172'> 172</a>       for i in ( 1..maximum_day_count )
</pre></code><p>Go forward one day.</p>
<code title='Line 176, ./lib/monkey_patching/date.rb'><pre><a name='176'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L176'> 176</a>         date = date.next_day
</pre></code><p>If this is a Commons adjournnment day or a Commons virtual sitting day ...</p>
<code title='Line 179, ./lib/monkey_patching/date.rb'><pre><a name='179'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L179'> 179</a>         if date.is_commons_adjournment_day? or date.is_commons_virtual_sitting_day?
</pre></code><p>... add one to the non-sitting scrutiny day count.</p>
<code title='Line 182, ./lib/monkey_patching/date.rb'><pre><a name='182'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L182'> 182</a>           non_sitting_scrutiny_day_count +=1
</pre></code><p>If this is not a Commons adjournnment day or a Commons virtual sitting day ...</p>
<code title='Line 185, ./lib/monkey_patching/date.rb'><pre><a name='185'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L185'> 185</a>         else
</pre></code><p>... stop cycling through following days.</p>
<code title='Line 188, ./lib/monkey_patching/date.rb'><pre><a name='188'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L188'> 188</a>           break
</pre></code><code title='Line 189, ./lib/monkey_patching/date.rb'><pre><a name='189'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L189'> 189</a>         end
</pre></code><code title='Line 190, ./lib/monkey_patching/date.rb'><pre><a name='190'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L190'> 190</a>       end
</pre></code><p>We want to cycle through the preceding days until we reach the maximum day count passed into this function.</p>
<code title='Line 193, ./lib/monkey_patching/date.rb'><pre><a name='193'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L193'> 193</a>       date = self
</pre></code><code title='Line 194, ./lib/monkey_patching/date.rb'><pre><a name='194'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L194'> 194</a>       for i in ( 1..maximum_day_count )
</pre></code><p>Go back one day.</p>
<code title='Line 197, ./lib/monkey_patching/date.rb'><pre><a name='197'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L197'> 197</a>         date = date.prev_day
</pre></code><p>If this is a Commons adjournnment day or a Commons virtual sitting day ...</p>
<code title='Line 200, ./lib/monkey_patching/date.rb'><pre><a name='200'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L200'> 200</a>         if date.is_commons_adjournment_day? or date.is_commons_virtual_sitting_day?
</pre></code><p>... add one to the non-sitting scrutiny day count.</p>
<code title='Line 203, ./lib/monkey_patching/date.rb'><pre><a name='203'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L203'> 203</a>           non_sitting_scrutiny_day_count +=1
</pre></code><p>If this is not a Commons adjournnment day or a Commons virtual sitting day ...</p>
<code title='Line 206, ./lib/monkey_patching/date.rb'><pre><a name='206'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L206'> 206</a>         else  
</pre></code><p>... stop cycling through preceding days.</p>
<code title='Line 209, ./lib/monkey_patching/date.rb'><pre><a name='209'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L209'> 209</a>           break
</pre></code><code title='Line 210, ./lib/monkey_patching/date.rb'><pre><a name='210'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L210'> 210</a>         end
</pre></code><code title='Line 211, ./lib/monkey_patching/date.rb'><pre><a name='211'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L211'> 211</a>       end
</pre></code><p>If the total number of continuous non-sitting scrutiny days is more than the maximum day count ...</p>
<code title='Line 214, ./lib/monkey_patching/date.rb'><pre><a name='214'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L214'> 214</a>       if non_sitting_scrutiny_day_count > maximum_day_count
</pre></code><p>... then this day does not count as a non-sitting scrutiny day.</p>
<code title='Line 217, ./lib/monkey_patching/date.rb'><pre><a name='217'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L217'> 217</a>         is_commons_non_sitting_scrutiny_day = false
</pre></code><p>If the total number of continuous non-sitting scrutiny days is less than or the same as the maximum day count ...</p>
<code title='Line 220, ./lib/monkey_patching/date.rb'><pre><a name='220'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L220'> 220</a>       else
</pre></code><p>... then this day does count as a non-sitting scrutiny day.</p>
<code title='Line 223, ./lib/monkey_patching/date.rb'><pre><a name='223'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L223'> 223</a>         is_commons_non_sitting_scrutiny_day = true
</pre></code><code title='Line 224, ./lib/monkey_patching/date.rb'><pre><a name='224'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L224'> 224</a>       end
</pre></code><p>Returns if this day is a Commons non-sitting scrutiny day</p>
<code title='Line 227, ./lib/monkey_patching/date.rb'><pre><a name='227'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L227'> 227</a>       is_commons_non_sitting_scrutiny_day
</pre></code><code title='Line 228, ./lib/monkey_patching/date.rb'><pre><a name='228'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L228'> 228</a>     end
</pre></code><code title='Line 229, ./lib/monkey_patching/date.rb'><pre><a name='229'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L229'> 229</a>   end
</pre></code><h3>We want to check if this is a non-sitting scrutiny day in the Lords.</h3>
<p>During a short adjournment, adjournment days count toward the scrutiny period.</p>
<p>This method allows the definition of a “short” adjournment to be adjusted by passing in a maximum day count.</p>
<p>In all known cases “short” is defined as not more than four days.</p>
<p>For the purposes of calculating non-sitting scrutiny days, virtual sitting days also count.</p>
<code title='Line 241, ./lib/monkey_patching/date.rb'><pre><a name='241'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L241'> 241</a>   def is_lords_non_sitting_scrutiny_day?( maximum_day_count )
</pre></code><h3>We want to check if this is a Lords adjournnment day or a Lords virtual sitting day.</h3>
<code title='Line 245, ./lib/monkey_patching/date.rb'><pre><a name='245'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L245'> 245</a>     if self.is_lords_adjournment_day? or self.is_lords_virtual_sitting_day?
</pre></code><p>Having found that this is a Lords adjournnment day or a Lords virtual sitting day, we start the adjournment day count at 1.</p>
<code title='Line 249, ./lib/monkey_patching/date.rb'><pre><a name='249'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L249'> 249</a>       non_sitting_scrutiny_day_count = 1
</pre></code><p>We want to cycle through the following days until we reach the maximum day count passed into this function.</p>
<code title='Line 253, ./lib/monkey_patching/date.rb'><pre><a name='253'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L253'> 253</a>       date = self
</pre></code><code title='Line 254, ./lib/monkey_patching/date.rb'><pre><a name='254'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L254'> 254</a>       for i in ( 1..maximum_day_count )
</pre></code><p>Go forward one day.</p>
<code title='Line 258, ./lib/monkey_patching/date.rb'><pre><a name='258'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L258'> 258</a>         date = date.next_day
</pre></code><p>If this is a Lords adjournnment day or a Lords virtual sitting day ...</p>
<code title='Line 261, ./lib/monkey_patching/date.rb'><pre><a name='261'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L261'> 261</a>         if date.is_lords_adjournment_day? or date.is_lords_virtual_sitting_day?
</pre></code><p>... add one to the non-sitting scrutiny day count.</p>
<code title='Line 264, ./lib/monkey_patching/date.rb'><pre><a name='264'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L264'> 264</a>           non_sitting_scrutiny_day_count +=1
</pre></code><p>If this is not a Lords adjournnment day or a Lords virtual sitting day ...</p>
<code title='Line 267, ./lib/monkey_patching/date.rb'><pre><a name='267'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L267'> 267</a>         else
</pre></code><p>... stop cycling through following days.</p>
<code title='Line 270, ./lib/monkey_patching/date.rb'><pre><a name='270'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L270'> 270</a>           break
</pre></code><code title='Line 271, ./lib/monkey_patching/date.rb'><pre><a name='271'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L271'> 271</a>         end
</pre></code><code title='Line 272, ./lib/monkey_patching/date.rb'><pre><a name='272'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L272'> 272</a>       end
</pre></code><p>We want to cycle through the preceding days until we reach the maximum day count passed into this function.</p>
<code title='Line 275, ./lib/monkey_patching/date.rb'><pre><a name='275'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L275'> 275</a>       date = self
</pre></code><code title='Line 276, ./lib/monkey_patching/date.rb'><pre><a name='276'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L276'> 276</a>       for i in ( 1..maximum_day_count )
</pre></code><p>Go back one day.</p>
<code title='Line 279, ./lib/monkey_patching/date.rb'><pre><a name='279'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L279'> 279</a>         date = date.prev_day
</pre></code><p>If this is a Lords adjournnment day or a Lords virtual sitting day ...</p>
<code title='Line 282, ./lib/monkey_patching/date.rb'><pre><a name='282'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L282'> 282</a>         if date.is_lords_adjournment_day? or date.is_lords_virtual_sitting_day?
</pre></code><p>... add one to the non-sitting scrutiny day count.</p>
<code title='Line 285, ./lib/monkey_patching/date.rb'><pre><a name='285'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L285'> 285</a>           non_sitting_scrutiny_day_count +=1
</pre></code><p>If this is not a Lords adjournnment day or a Lords virtual sitting day ...</p>
<code title='Line 288, ./lib/monkey_patching/date.rb'><pre><a name='288'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L288'> 288</a>         else  
</pre></code><p>... stop cycling through preceding days.</p>
<code title='Line 291, ./lib/monkey_patching/date.rb'><pre><a name='291'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L291'> 291</a>           break
</pre></code><code title='Line 292, ./lib/monkey_patching/date.rb'><pre><a name='292'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L292'> 292</a>         end
</pre></code><code title='Line 293, ./lib/monkey_patching/date.rb'><pre><a name='293'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L293'> 293</a>       end
</pre></code><p>If the total number of continuous non-sitting scrutiny days is more than the maximum day count ...</p>
<code title='Line 296, ./lib/monkey_patching/date.rb'><pre><a name='296'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L296'> 296</a>       if non_sitting_scrutiny_day_count > maximum_day_count
</pre></code><p>... then this day does not count as a non-sitting scrutiny day.</p>
<code title='Line 299, ./lib/monkey_patching/date.rb'><pre><a name='299'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L299'> 299</a>         is_lords_non_sitting_scrutiny_day = false
</pre></code><p>If the total number of continuous non-sitting scrutiny days is less than or the same as the maximum day count ...</p>
<code title='Line 302, ./lib/monkey_patching/date.rb'><pre><a name='302'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L302'> 302</a>       else
</pre></code><p>... then this day does count as a non-sitting scrutiny day.</p>
<code title='Line 305, ./lib/monkey_patching/date.rb'><pre><a name='305'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L305'> 305</a>         is_lords_non_sitting_scrutiny_day = true
</pre></code><code title='Line 306, ./lib/monkey_patching/date.rb'><pre><a name='306'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L306'> 306</a>       end
</pre></code><p>Returns if this day is a Lords non-sitting scrutiny day</p>
<code title='Line 309, ./lib/monkey_patching/date.rb'><pre><a name='309'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L309'> 309</a>       is_lords_non_sitting_scrutiny_day
</pre></code><code title='Line 310, ./lib/monkey_patching/date.rb'><pre><a name='310'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L310'> 310</a>     end
</pre></code><code title='Line 311, ./lib/monkey_patching/date.rb'><pre><a name='311'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L311'> 311</a>   end
</pre></code><p>(End of methods to calculate non-sitting scrutiny days in both Houses.)</p>
<h3>We want to check if this is a scrutiny day in the Commons.</h3>
<p>A scrutiny day in the Commons is either an actual sitting day in the Commons, or a non-sitting scrutiny day in the Commons.</p>
<p>We pass &#39;4&#39; as the maximum day count to the non-sitting scrutiny day calculation, because non-sitting scrutiny days are days within a series of not more than four non-sitting days.</p>
<code title='Line 321, ./lib/monkey_patching/date.rb'><pre><a name='321'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L321'> 321</a>   def is_commons_scrutiny_day?
</pre></code><code title='Line 322, ./lib/monkey_patching/date.rb'><pre><a name='322'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L322'> 322</a>     self.is_commons_actual_sitting_day? or self.is_commons_non_sitting_scrutiny_day?( 4 )
</pre></code><code title='Line 323, ./lib/monkey_patching/date.rb'><pre><a name='323'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L323'> 323</a>   end
</pre></code><h3>We want to check if this is a scrutiny day in the Lords.</h3>
<p>A scrutiny day in the Lords is either an actual sitting day in the Lords, or a non-sitting scrutiny day in the Lords.</p>
<p>We pass &#39;4&#39; as the maximum day count to the non-sitting scrutiny day calculation, because  non-sitting scrutiny days are days within a series of not more than four non-sitting days.</p>
<code title='Line 331, ./lib/monkey_patching/date.rb'><pre><a name='331'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L331'> 331</a>   def is_lords_scrutiny_day?
</pre></code><code title='Line 332, ./lib/monkey_patching/date.rb'><pre><a name='332'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L332'> 332</a>     self.is_lords_actual_sitting_day? or self.is_lords_non_sitting_scrutiny_day?( 4 )
</pre></code><code title='Line 333, ./lib/monkey_patching/date.rb'><pre><a name='333'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L333'> 333</a>   end
</pre></code><h3>We want to check if this is a scrutiny day in <em>either</em> House.</h3>
<code title='Line 337, ./lib/monkey_patching/date.rb'><pre><a name='337'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L337'> 337</a>   def is_either_house_scrutiny_day?
</pre></code><code title='Line 338, ./lib/monkey_patching/date.rb'><pre><a name='338'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L338'> 338</a>     self.is_commons_scrutiny_day? or self.is_lords_scrutiny_day?
</pre></code><code title='Line 339, ./lib/monkey_patching/date.rb'><pre><a name='339'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L339'> 339</a>   end
</pre></code><h3>We want to check if this is a scrutiny day in <em>both</em> Houses.</h3>
<code title='Line 343, ./lib/monkey_patching/date.rb'><pre><a name='343'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L343'> 343</a>   def is_joint_scrutiny_day?
</pre></code><code title='Line 344, ./lib/monkey_patching/date.rb'><pre><a name='344'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L344'> 344</a>     self.is_commons_scrutiny_day? and self.is_lords_scrutiny_day?
</pre></code><code title='Line 345, ./lib/monkey_patching/date.rb'><pre><a name='345'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L345'> 345</a>   end
</pre></code><p>(End of set of methods to work out the type of a given day.)</p>
<h2>A set of methods to find the first day of a given type.</h2>
<h3>We want to find the first scrutiny day in <em>either</em> House.</h3>
<p>This method is used when a Statutory Instrument is laid outside of a scrutiny period, that is: during a non-sitting period of more than four days, or during a period in which Parliament is prorogued. In such cases, the clock starts from the first actual sitting day in either House following the laying.</p>
<p>This method is used for bicameral negative SIs - and bicameral made affirmatives where the enabling legislation specifies that either House can be sitting.</p>
<code title='Line 358, ./lib/monkey_patching/date.rb'><pre><a name='358'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L358'> 358</a>   def first_scrutiny_day_in_either_house
</pre></code><p>If this is a day on which the calendar is not yet populated ...</p>
<code title='Line 361, ./lib/monkey_patching/date.rb'><pre><a name='361'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L361'> 361</a>     if self.is_calendar_not_populated?
</pre></code><p>... then we cannot find a first scrutiny day so we stop looking.</p>
<code title='Line 364, ./lib/monkey_patching/date.rb'><pre><a name='364'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L364'> 364</a>       return nil
</pre></code><p>If this is a day on which the calendar is populated ...</p>
<code title='Line 367, ./lib/monkey_patching/date.rb'><pre><a name='367'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L367'> 367</a>     else
</pre></code><p>... then if this is not a scrutiny day in <em>either</em> House ...</p>
<code title='Line 370, ./lib/monkey_patching/date.rb'><pre><a name='370'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L370'> 370</a>       unless self.is_either_house_scrutiny_day?
</pre></code><p>... then go to the next day and check that.</p>
<code title='Line 373, ./lib/monkey_patching/date.rb'><pre><a name='373'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L373'> 373</a>         self.next_day.first_scrutiny_day_in_either_house
</pre></code><p>... then if this is a scrutiny day in either House ...</p>
<code title='Line 376, ./lib/monkey_patching/date.rb'><pre><a name='376'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L376'> 376</a>       else
</pre></code><p>... then return this day as the first scrutiny day in either House.</p>
<code title='Line 379, ./lib/monkey_patching/date.rb'><pre><a name='379'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L379'> 379</a>         self
</pre></code><code title='Line 380, ./lib/monkey_patching/date.rb'><pre><a name='380'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L380'> 380</a>       end
</pre></code><code title='Line 381, ./lib/monkey_patching/date.rb'><pre><a name='381'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L381'> 381</a>     end
</pre></code><code title='Line 382, ./lib/monkey_patching/date.rb'><pre><a name='382'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L382'> 382</a>   end
</pre></code><h3>We want to find the first scrutiny day in <em>both</em> Houses.</h3>
<p>This method is used when a Statutory Instrument is laid outside of a scrutiny period, that is: during an adjournment of more than four days, or during a period in which Parliament is prorogued. The clock starts from the first actual sitting day in both Houses following the laying.</p>
<p>This method is used for bicameral made affirmatives where the enabling legislation specifies that both Houses must be sitting.</p>
<code title='Line 390, ./lib/monkey_patching/date.rb'><pre><a name='390'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L390'> 390</a>   def first_joint_scrutiny_day
</pre></code><p>If this is a day on which the calendar is not yet populated ...</p>
<code title='Line 393, ./lib/monkey_patching/date.rb'><pre><a name='393'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L393'> 393</a>     if self.is_calendar_not_populated?
</pre></code><p>... then we cannot find a first scrutiny day so we stop looking.</p>
<code title='Line 396, ./lib/monkey_patching/date.rb'><pre><a name='396'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L396'> 396</a>       return nil
</pre></code><p>If this is a day on which the calendar is populated ...</p>
<code title='Line 399, ./lib/monkey_patching/date.rb'><pre><a name='399'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L399'> 399</a>     else
</pre></code><p>... then if this is not a scrutiny day in both Houses ...</p>
<code title='Line 402, ./lib/monkey_patching/date.rb'><pre><a name='402'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L402'> 402</a>       unless self.is_joint_scrutiny_day?
</pre></code><p>... then go to the next day and check that.</p>
<code title='Line 405, ./lib/monkey_patching/date.rb'><pre><a name='405'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L405'> 405</a>         self.next_day.first_joint_scrutiny_day
</pre></code><p>... then if this is a scrutiny day in both Houses ...</p>
<code title='Line 408, ./lib/monkey_patching/date.rb'><pre><a name='408'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L408'> 408</a>       else
</pre></code><p>... then return this day as the first scrutiny day in both Houses.</p>
<code title='Line 411, ./lib/monkey_patching/date.rb'><pre><a name='411'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L411'> 411</a>         self
</pre></code><code title='Line 412, ./lib/monkey_patching/date.rb'><pre><a name='412'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L412'> 412</a>       end
</pre></code><code title='Line 413, ./lib/monkey_patching/date.rb'><pre><a name='413'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L413'> 413</a>     end
</pre></code><code title='Line 414, ./lib/monkey_patching/date.rb'><pre><a name='414'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L414'> 414</a>   end
</pre></code><h3>We want to find the first scrutiny day in the Commons.</h3>
<p>This method is used when a Statutory Instrument is laid outside of a scrutiny period, that is: during an adjournment of more than four days, or during a period in which Parliament is prorogued. The clock starts from the first actual sitting day in the Commons following the laying.</p>
<p>This method is used for negative or made affirmative SIs - laid in the Commons and not laid in the Lords.</p>
<code title='Line 422, ./lib/monkey_patching/date.rb'><pre><a name='422'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L422'> 422</a>   def first_commons_scrutiny_day
</pre></code><p>If this is a day on which the calendar is not yet populated ...</p>
<code title='Line 425, ./lib/monkey_patching/date.rb'><pre><a name='425'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L425'> 425</a>     if self.is_calendar_not_populated?
</pre></code><p>... then we cannot find a first Commons scrutiny day so we stop looking.</p>
<code title='Line 428, ./lib/monkey_patching/date.rb'><pre><a name='428'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L428'> 428</a>       return nil
</pre></code><p>If this is a day on which the calendar is populated ...</p>
<code title='Line 431, ./lib/monkey_patching/date.rb'><pre><a name='431'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L431'> 431</a>     else
</pre></code><p>... then if this is not a scrutiny day in the Commons ...</p>
<code title='Line 434, ./lib/monkey_patching/date.rb'><pre><a name='434'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L434'> 434</a>       unless self.is_commons_scrutiny_day?
</pre></code><p>... then go to the next day and check that.</p>
<code title='Line 437, ./lib/monkey_patching/date.rb'><pre><a name='437'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L437'> 437</a>         self.next_day.first_commons_scrutiny_day
</pre></code><p>... then if this is a scrutiny day in the Commons ...</p>
<code title='Line 440, ./lib/monkey_patching/date.rb'><pre><a name='440'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L440'> 440</a>       else
</pre></code><p>... then return this day as the first scrutiny day in the Commons.</p>
<code title='Line 443, ./lib/monkey_patching/date.rb'><pre><a name='443'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L443'> 443</a>         self
</pre></code><code title='Line 444, ./lib/monkey_patching/date.rb'><pre><a name='444'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L444'> 444</a>       end
</pre></code><code title='Line 445, ./lib/monkey_patching/date.rb'><pre><a name='445'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L445'> 445</a>     end
</pre></code><code title='Line 446, ./lib/monkey_patching/date.rb'><pre><a name='446'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L446'> 446</a>   end
</pre></code><h3>We want to find the first parliamentary sitting day in both Houses.</h3>
<p>This method is used when a Proposed Negative Statutory Instrument is laid.</p>
<p>Even if a PNSI is laid on a joint parliamentary sitting day, the clock does not start until the next joint parliamentary sitting day.</p>
<code title='Line 454, ./lib/monkey_patching/date.rb'><pre><a name='454'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L454'> 454</a>   def first_joint_parliamentary_sitting_day
</pre></code><p>If this is a day on which the calendar is not yet populated ...</p>
<code title='Line 457, ./lib/monkey_patching/date.rb'><pre><a name='457'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L457'> 457</a>     if self.is_calendar_not_populated?
</pre></code><p>... then we cannot find a first parliamentary sitting day in both Houses so we stop looking.</p>
<code title='Line 460, ./lib/monkey_patching/date.rb'><pre><a name='460'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L460'> 460</a>       return nil
</pre></code><p>If this is a day on which the calendar is populated ...</p>
<code title='Line 463, ./lib/monkey_patching/date.rb'><pre><a name='463'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L463'> 463</a>     else
</pre></code><p>... then if this is not a parliamentary sitting day in both Houses ...</p>
<code title='Line 466, ./lib/monkey_patching/date.rb'><pre><a name='466'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L466'> 466</a>       unless self.is_joint_parliamentary_sitting_day?
</pre></code><p>... then go to the next day and check that.</p>
<code title='Line 469, ./lib/monkey_patching/date.rb'><pre><a name='469'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L469'> 469</a>         self.next_day.first_joint_parliamentary_sitting_day
</pre></code><p>... then if this is a parliamentary sitting day in both Houses ...</p>
<code title='Line 472, ./lib/monkey_patching/date.rb'><pre><a name='472'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L472'> 472</a>       else
</pre></code><p>... then return this day as the first parliamentary sitting day in both Houses.</p>
<code title='Line 475, ./lib/monkey_patching/date.rb'><pre><a name='475'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L475'> 475</a>         self
</pre></code><code title='Line 476, ./lib/monkey_patching/date.rb'><pre><a name='476'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L476'> 476</a>       end
</pre></code><code title='Line 477, ./lib/monkey_patching/date.rb'><pre><a name='477'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L477'> 477</a>     end
</pre></code><code title='Line 478, ./lib/monkey_patching/date.rb'><pre><a name='478'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L478'> 478</a>   end
</pre></code><h3>We want to find the first actual sitting day in both Houses.</h3>
<p>This method is used to calculate periods A and B for treaties.</p>
<p>Even if a treaty is laid or a ministerial statement is made on a joint actual sitting day, the clock does not start until the next joint actual sitting day.</p>
<code title='Line 486, ./lib/monkey_patching/date.rb'><pre><a name='486'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L486'> 486</a>   def first_joint_actual_sitting_day
</pre></code><p>If this is a day on which the calendar is not yet populated ...</p>
<code title='Line 489, ./lib/monkey_patching/date.rb'><pre><a name='489'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L489'> 489</a>     if self.is_calendar_not_populated?
</pre></code><p>... then we cannot find a first actual sitting day in both Houses so we stop looking.</p>
<code title='Line 492, ./lib/monkey_patching/date.rb'><pre><a name='492'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L492'> 492</a>       return nil
</pre></code><p>If this is a day on which the calendar is populated ...</p>
<code title='Line 495, ./lib/monkey_patching/date.rb'><pre><a name='495'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L495'> 495</a>     else
</pre></code><p>... then if this is not an actual sitting day in both Houses ...</p>
<code title='Line 498, ./lib/monkey_patching/date.rb'><pre><a name='498'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L498'> 498</a>       unless self.is_joint_actual_sitting_day?
</pre></code><p>... then go to the next day and check that.</p>
<code title='Line 501, ./lib/monkey_patching/date.rb'><pre><a name='501'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L501'> 501</a>         self.next_day.first_joint_actual_sitting_day
</pre></code><p>... then if this is an actual sitting day in both Houses ...</p>
<code title='Line 504, ./lib/monkey_patching/date.rb'><pre><a name='504'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L504'> 504</a>       else
</pre></code><p>... then return this day as the first actual sitting day in both Houses.</p>
<code title='Line 507, ./lib/monkey_patching/date.rb'><pre><a name='507'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L507'> 507</a>         self
</pre></code><code title='Line 508, ./lib/monkey_patching/date.rb'><pre><a name='508'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L508'> 508</a>       end
</pre></code><code title='Line 509, ./lib/monkey_patching/date.rb'><pre><a name='509'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L509'> 509</a>     end
</pre></code><code title='Line 510, ./lib/monkey_patching/date.rb'><pre><a name='510'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L510'> 510</a>   end
</pre></code><h3>We want to find the first actual sitting day in the House of Commons.</h3>
<p>This method is used by the House of Commons only sitting day calculation.</p>
<p>Even if an instrument is laid on a House of Commons actual sitting day, the clock does not start until the next House of Commons actual sitting day.</p>
<code title='Line 518, ./lib/monkey_patching/date.rb'><pre><a name='518'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L518'> 518</a>   def first_commons_actual_sitting_day
</pre></code><p>If this is a day on which the calendar is not yet populated ...</p>
<code title='Line 521, ./lib/monkey_patching/date.rb'><pre><a name='521'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L521'> 521</a>     if self.is_calendar_not_populated?
</pre></code><p>... then we cannot find a first actual sitting day in the House of Commons so we stop looking.</p>
<code title='Line 524, ./lib/monkey_patching/date.rb'><pre><a name='524'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L524'> 524</a>       return nil
</pre></code><p>If this is a day on which the calendar is populated ...</p>
<code title='Line 527, ./lib/monkey_patching/date.rb'><pre><a name='527'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L527'> 527</a>     else
</pre></code><p>... then if this is not an actual sitting day in the House of Commons ...</p>
<code title='Line 530, ./lib/monkey_patching/date.rb'><pre><a name='530'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L530'> 530</a>       unless self.is_commons_actual_sitting_day?
</pre></code><p>... then go to the next day and check that.</p>
<code title='Line 533, ./lib/monkey_patching/date.rb'><pre><a name='533'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L533'> 533</a>         self.next_day.first_commons_actual_sitting_day
</pre></code><p>... then if this is an actual sitting day in the House of Commons ...</p>
<code title='Line 536, ./lib/monkey_patching/date.rb'><pre><a name='536'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L536'> 536</a>       else
</pre></code><p>... then return this day as the first actual sitting day in the House of Commons.</p>
<code title='Line 539, ./lib/monkey_patching/date.rb'><pre><a name='539'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L539'> 539</a>         self
</pre></code><code title='Line 540, ./lib/monkey_patching/date.rb'><pre><a name='540'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L540'> 540</a>       end
</pre></code><code title='Line 541, ./lib/monkey_patching/date.rb'><pre><a name='541'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L541'> 541</a>     end
</pre></code><code title='Line 542, ./lib/monkey_patching/date.rb'><pre><a name='542'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L542'> 542</a>   end
</pre></code><p>(End of set of methods to find the first day of a given type.)</p>
<h2>A set of methods to return which higher level parliamentary time periods a calendar day sits in.</h2>
<p>A calendar day may sit in either a dissolution period or a Parliament period.</p>
<p>If a calendar day sits inside a Parliament period, it may sit inside either a session or a prorogation period.</p>
<h3>We want to find which dissolution period a calendar day sits in, if any.</h3>
<code title='Line 556, ./lib/monkey_patching/date.rb'><pre><a name='556'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L556'> 556</a>   def dissolution_period
</pre></code><code title='Line 557, ./lib/monkey_patching/date.rb'><pre><a name='557'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L557'> 557</a>     DissolutionPeriod.all.where( "start_date <= ?", self ).where( "end_date >= ?", self).first
</pre></code><code title='Line 558, ./lib/monkey_patching/date.rb'><pre><a name='558'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L558'> 558</a>   end
</pre></code><h3>We want to find which Parliament period a calendar day sits in, if any.</h3>
<code title='Line 561, ./lib/monkey_patching/date.rb'><pre><a name='561'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L561'> 561</a>   def parliament_period
</pre></code><code title='Line 562, ./lib/monkey_patching/date.rb'><pre><a name='562'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L562'> 562</a>     ParliamentPeriod.all.where( "start_date <= ?", self ).order( "start_date desc" ).first
</pre></code><code title='Line 563, ./lib/monkey_patching/date.rb'><pre><a name='563'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L563'> 563</a>   end
</pre></code><h3>We want to find which prorogoration period a calendar day sits in, if any.</h3>
<code title='Line 566, ./lib/monkey_patching/date.rb'><pre><a name='566'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L566'> 566</a>   def prorogation_period
</pre></code><code title='Line 567, ./lib/monkey_patching/date.rb'><pre><a name='567'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L567'> 567</a>     ProrogationPeriod.all.where( "start_date <= ?", self ).where( "end_date >= ?", self).first
</pre></code><code title='Line 568, ./lib/monkey_patching/date.rb'><pre><a name='568'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L568'> 568</a>   end
</pre></code><h3>We want to find which session a calendar day sits in, if any.</h3>
<code title='Line 571, ./lib/monkey_patching/date.rb'><pre><a name='571'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L571'> 571</a>   def session
</pre></code><code title='Line 572, ./lib/monkey_patching/date.rb'><pre><a name='572'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L572'> 572</a>     Session.all.where( "start_date <= ?", self ).order( "start_date desc" ).first
</pre></code><code title='Line 573, ./lib/monkey_patching/date.rb'><pre><a name='573'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L573'> 573</a>   end
</pre></code><h3>Generate label for the day type in the Commons in a session.</h3>
<code title='Line 576, ./lib/monkey_patching/date.rb'><pre><a name='576'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L576'> 576</a>   def commons_day_type
</pre></code><code title='Line 577, ./lib/monkey_patching/date.rb'><pre><a name='577'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L577'> 577</a>     if self.is_commons_parliamentary_sitting_day?
</pre></code><code title='Line 578, ./lib/monkey_patching/date.rb'><pre><a name='578'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L578'> 578</a>       day_type = 'Parliamentary sitting day'
</pre></code><code title='Line 579, ./lib/monkey_patching/date.rb'><pre><a name='579'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L579'> 579</a>     elsif self.is_commons_actual_sitting_day?
</pre></code><code title='Line 580, ./lib/monkey_patching/date.rb'><pre><a name='580'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L580'> 580</a>       day_type = "Continuation sitting day"
</pre></code><code title='Line 581, ./lib/monkey_patching/date.rb'><pre><a name='581'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L581'> 581</a>     elsif self.is_commons_virtual_sitting_day?
</pre></code><code title='Line 582, ./lib/monkey_patching/date.rb'><pre><a name='582'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L582'> 582</a>       day_type = 'Virtual sitting day'
</pre></code><code title='Line 583, ./lib/monkey_patching/date.rb'><pre><a name='583'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L583'> 583</a>     elsif self.is_commons_non_sitting_scrutiny_day?( 4 )
</pre></code><code title='Line 584, ./lib/monkey_patching/date.rb'><pre><a name='584'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L584'> 584</a>       day_type = 'Scrutiny non-sitting day'
</pre></code><code title='Line 585, ./lib/monkey_patching/date.rb'><pre><a name='585'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L585'> 585</a>     elsif self.is_commons_adjournment_day?
</pre></code><code title='Line 586, ./lib/monkey_patching/date.rb'><pre><a name='586'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L586'> 586</a>       day_type = self.commons_adjournment_day_label
</pre></code><code title='Line 587, ./lib/monkey_patching/date.rb'><pre><a name='587'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L587'> 587</a>     elsif self.is_prorogation_day?
</pre></code><code title='Line 588, ./lib/monkey_patching/date.rb'><pre><a name='588'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L588'> 588</a>       day_type = 'Prorogation'
</pre></code><code title='Line 589, ./lib/monkey_patching/date.rb'><pre><a name='589'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L589'> 589</a>     elsif self.is_dissolution_day?
</pre></code><code title='Line 590, ./lib/monkey_patching/date.rb'><pre><a name='590'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L590'> 590</a>       day_type = 'Dissolution'
</pre></code><code title='Line 591, ./lib/monkey_patching/date.rb'><pre><a name='591'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L591'> 591</a>     end
</pre></code><code title='Line 592, ./lib/monkey_patching/date.rb'><pre><a name='592'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L592'> 592</a>     day_type
</pre></code><code title='Line 593, ./lib/monkey_patching/date.rb'><pre><a name='593'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L593'> 593</a>   end
</pre></code><h3>Generate label for the day type in the Lords in a session.</h3>
<code title='Line 596, ./lib/monkey_patching/date.rb'><pre><a name='596'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L596'> 596</a>   def lords_day_type
</pre></code><code title='Line 597, ./lib/monkey_patching/date.rb'><pre><a name='597'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L597'> 597</a>     if self.is_lords_parliamentary_sitting_day?
</pre></code><code title='Line 598, ./lib/monkey_patching/date.rb'><pre><a name='598'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L598'> 598</a>       day_type = 'Parliamentary sitting day'
</pre></code><code title='Line 599, ./lib/monkey_patching/date.rb'><pre><a name='599'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L599'> 599</a>     elsif self.is_lords_actual_sitting_day?
</pre></code><code title='Line 600, ./lib/monkey_patching/date.rb'><pre><a name='600'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L600'> 600</a>       day_type = "Continuation sitting day"
</pre></code><code title='Line 601, ./lib/monkey_patching/date.rb'><pre><a name='601'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L601'> 601</a>     elsif self.is_lords_virtual_sitting_day?
</pre></code><code title='Line 602, ./lib/monkey_patching/date.rb'><pre><a name='602'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L602'> 602</a>       day_type = 'Virtual sitting day'
</pre></code><code title='Line 603, ./lib/monkey_patching/date.rb'><pre><a name='603'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L603'> 603</a>     elsif self.is_lords_non_sitting_scrutiny_day?( 4 )
</pre></code><code title='Line 604, ./lib/monkey_patching/date.rb'><pre><a name='604'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L604'> 604</a>       day_type = 'Scrutiny non-sitting day'
</pre></code><code title='Line 605, ./lib/monkey_patching/date.rb'><pre><a name='605'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L605'> 605</a>     elsif self.is_lords_adjournment_day?
</pre></code><code title='Line 606, ./lib/monkey_patching/date.rb'><pre><a name='606'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L606'> 606</a>       day_type = self.lords_adjournment_day_label
</pre></code><code title='Line 607, ./lib/monkey_patching/date.rb'><pre><a name='607'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L607'> 607</a>     elsif self.is_prorogation_day?
</pre></code><code title='Line 608, ./lib/monkey_patching/date.rb'><pre><a name='608'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L608'> 608</a>       day_type = 'Prorogation'
</pre></code><code title='Line 609, ./lib/monkey_patching/date.rb'><pre><a name='609'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L609'> 609</a>     elsif self.is_dissolution_day?
</pre></code><code title='Line 610, ./lib/monkey_patching/date.rb'><pre><a name='610'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L610'> 610</a>       day_type = 'Dissolution'
</pre></code><code title='Line 611, ./lib/monkey_patching/date.rb'><pre><a name='611'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L611'> 611</a>     end
</pre></code><code title='Line 612, ./lib/monkey_patching/date.rb'><pre><a name='612'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L612'> 612</a>     day_type
</pre></code><code title='Line 613, ./lib/monkey_patching/date.rb'><pre><a name='613'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L613'> 613</a>   end
</pre></code><h3>Generate a label to say whether it&#39;s a scrutiny day in the Commons or not.</h3>
<code title='Line 616, ./lib/monkey_patching/date.rb'><pre><a name='616'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L616'> 616</a>   def is_commons_scrutiny_day_label
</pre></code><code title='Line 617, ./lib/monkey_patching/date.rb'><pre><a name='617'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L617'> 617</a>     if self.is_commons_scrutiny_day?
</pre></code><code title='Line 618, ./lib/monkey_patching/date.rb'><pre><a name='618'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L618'> 618</a>       label = 'True'
</pre></code><code title='Line 619, ./lib/monkey_patching/date.rb'><pre><a name='619'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L619'> 619</a>     else
</pre></code><code title='Line 620, ./lib/monkey_patching/date.rb'><pre><a name='620'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L620'> 620</a>       label = 'False'
</pre></code><code title='Line 621, ./lib/monkey_patching/date.rb'><pre><a name='621'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L621'> 621</a>     end
</pre></code><code title='Line 622, ./lib/monkey_patching/date.rb'><pre><a name='622'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L622'> 622</a>     label
</pre></code><code title='Line 623, ./lib/monkey_patching/date.rb'><pre><a name='623'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L623'> 623</a>   end
</pre></code><h3>Generate a label to say whether it&#39;s a scrutiny day in the Lords or not.</h3>
<code title='Line 626, ./lib/monkey_patching/date.rb'><pre><a name='626'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L626'> 626</a>   def is_lords_scrutiny_day_label
</pre></code><code title='Line 627, ./lib/monkey_patching/date.rb'><pre><a name='627'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L627'> 627</a>     if self.is_lords_scrutiny_day?
</pre></code><code title='Line 628, ./lib/monkey_patching/date.rb'><pre><a name='628'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L628'> 628</a>       label = 'True'
</pre></code><code title='Line 629, ./lib/monkey_patching/date.rb'><pre><a name='629'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L629'> 629</a>     else
</pre></code><code title='Line 630, ./lib/monkey_patching/date.rb'><pre><a name='630'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L630'> 630</a>       label = 'False'
</pre></code><code title='Line 631, ./lib/monkey_patching/date.rb'><pre><a name='631'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L631'> 631</a>     end
</pre></code><code title='Line 632, ./lib/monkey_patching/date.rb'><pre><a name='632'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L632'> 632</a>     label
</pre></code><code title='Line 633, ./lib/monkey_patching/date.rb'><pre><a name='633'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L633'> 633</a>   end
</pre></code><h3>A method to label a Commons adjournment day, with recess if applicable.</h3>
<code title='Line 636, ./lib/monkey_patching/date.rb'><pre><a name='636'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L636'> 636</a>   def commons_adjournment_day_label
</pre></code><code title='Line 637, ./lib/monkey_patching/date.rb'><pre><a name='637'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L637'> 637</a>     commons_adjournment_day_label = 'Adjournment day'
</pre></code><p>We attempt to find a recess on this date, in this House.</p>
<code title='Line 640, ./lib/monkey_patching/date.rb'><pre><a name='640'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L640'> 640</a>     recess_date = RecessDate
</pre></code><code title='Line 641, ./lib/monkey_patching/date.rb'><pre><a name='641'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L641'> 641</a>       .all
</pre></code><code title='Line 642, ./lib/monkey_patching/date.rb'><pre><a name='642'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L642'> 642</a>       .where( "start_date <= ?", self )
</pre></code><code title='Line 643, ./lib/monkey_patching/date.rb'><pre><a name='643'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L643'> 643</a>       .where( "end_date >= ?", self )
</pre></code><code title='Line 644, ./lib/monkey_patching/date.rb'><pre><a name='644'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L644'> 644</a>       .where( house_id: 1 )
</pre></code><code title='Line 645, ./lib/monkey_patching/date.rb'><pre><a name='645'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L645'> 645</a>       .first
</pre></code><p>If we find a recess date on this day, in this House ...</p>
<code title='Line 648, ./lib/monkey_patching/date.rb'><pre><a name='648'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L648'> 648</a>     if recess_date
</pre></code><p>... we append the description of the recess date to the label</p>
<code title='Line 651, ./lib/monkey_patching/date.rb'><pre><a name='651'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L651'> 651</a>       commons_adjournment_day_label += ' (' + recess_date.description + ')'
</pre></code><code title='Line 652, ./lib/monkey_patching/date.rb'><pre><a name='652'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L652'> 652</a>     end
</pre></code><code title='Line 653, ./lib/monkey_patching/date.rb'><pre><a name='653'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L653'> 653</a>     commons_adjournment_day_label
</pre></code><code title='Line 654, ./lib/monkey_patching/date.rb'><pre><a name='654'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L654'> 654</a>   end
</pre></code><h3>A method to label a Lords adjournment day, with recess if applicable.</h3>
<code title='Line 657, ./lib/monkey_patching/date.rb'><pre><a name='657'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L657'> 657</a>   def lords_adjournment_day_label
</pre></code><code title='Line 658, ./lib/monkey_patching/date.rb'><pre><a name='658'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L658'> 658</a>     lords_adjournment_day_label = 'Adjournment day'
</pre></code><p>We attempt to find a recess on this date, in this House.</p>
<code title='Line 661, ./lib/monkey_patching/date.rb'><pre><a name='661'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L661'> 661</a>     recess_date = RecessDate
</pre></code><code title='Line 662, ./lib/monkey_patching/date.rb'><pre><a name='662'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L662'> 662</a>       .all
</pre></code><code title='Line 663, ./lib/monkey_patching/date.rb'><pre><a name='663'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L663'> 663</a>       .where( "start_date <= ?", self )
</pre></code><code title='Line 664, ./lib/monkey_patching/date.rb'><pre><a name='664'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L664'> 664</a>       .where( "end_date >= ?", self )
</pre></code><code title='Line 665, ./lib/monkey_patching/date.rb'><pre><a name='665'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L665'> 665</a>       .where( house_id: 2 )
</pre></code><code title='Line 666, ./lib/monkey_patching/date.rb'><pre><a name='666'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L666'> 666</a>       .first
</pre></code><p>If we find a recess date on this day, in this House ...</p>
<code title='Line 669, ./lib/monkey_patching/date.rb'><pre><a name='669'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L669'> 669</a>     if recess_date
</pre></code><p>... we append the description of the recess date to the label</p>
<code title='Line 672, ./lib/monkey_patching/date.rb'><pre><a name='672'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L672'> 672</a>       lords_adjournment_day_label += ' (' + recess_date.description + ')'
</pre></code><code title='Line 673, ./lib/monkey_patching/date.rb'><pre><a name='673'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L673'> 673</a>     end
</pre></code><code title='Line 674, ./lib/monkey_patching/date.rb'><pre><a name='674'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L674'> 674</a>     lords_adjournment_day_label
</pre></code><code title='Line 675, ./lib/monkey_patching/date.rb'><pre><a name='675'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L675'> 675</a>   end
</pre></code><code title='Line 676, ./lib/monkey_patching/date.rb'><pre><a name='676'  class='githubline' href='https://github.com/ukparliament/egg-timer/tree/master/./lib/monkey_patching/date.rb#L676'> 676</a> end</pre></code></body></html>