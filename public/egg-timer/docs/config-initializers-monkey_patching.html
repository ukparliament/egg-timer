<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <link rel="icon" href="https://api.parliament.uk/egg-timer/favicon.ico">
		<meta name="viewport" content="width=device-width">
  <title>Documentation: config/initializers/monkey_patching.rb</title>
  <style>
  body {font-family:system-ui;
  max-width:48rem;
  font-size:1.2rem;
  line-height:1.4;
  margin:auto;}
  main {
  padding: 2rem 0;
  }
  pre {color:gray;}
  pre a {color:gray;text-decoration:none;}
  </style>
</head>
<body>
  <header>
    
    <p>
      On GitHub &rarr; 
      <a href="https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb">
        config/initializers/monkey_patching.rb
      </a>
    </p>
  </header>
  
  <main>
    <h1>A monkey patched Ruby date class to handle UK Parliament specific day types.</h1>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L2' title='View on GitHub'>2</a> module DateMonkeyPatch</code></pre>
<h2>A set of methods to work out the type of a given day.</h2>

<h3>We want to check if this is an actual sitting day in the Commons.</h3>

<p>We use a naive definition of a sitting day: this includes a calendar day when the Commons sits, together with following calendar days if the Commons sat through the night.</p>

<p>For example: if the Commons sat on a Tuesday and continued to sit overnight into Wednesday, both Tuesday and Wednesday would count as actual sitting days.</p>

<p>If the Tuesday sitting lasted long enough to overlap the starting time of the Wednesday sitting, the Tuesday would be a parliamentary sitting day, but the Wednesday would not.</p>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L14' title='View on GitHub'>14</a>   def is_commons_actual_sitting_day?</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L15' title='View on GitHub'>15</a>     SittingDay.all.where( &#39;start_date &lt;= ?&#39;,  self ).where( &#39;end_date &gt;= ?&#39;,  self ).where( house_id: 1 ).first</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L16' title='View on GitHub'>16</a>   end</code></pre>
<h3>We want to check if this is an actual sitting day in the Lords.</h3>

<p>We use a naive definition of a sitting day: this includes a calendar day when the Lords sits, together with following calendar days if the Lords sat through the night.</p>

<p>For example: if the Lords sat on a Tuesday and continued to sit overnight into Wednesday, both Tuesday and Wednesday would count as actual sitting days.</p>

<p>If the Tuesday sitting lasted long enough to overlap the starting time of the Wednesday sitting, the Tuesday would be a parliamentary sitting day, but the Wednesday would not.</p>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L26' title='View on GitHub'>26</a>   def is_lords_actual_sitting_day?</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L27' title='View on GitHub'>27</a>     SittingDay.all.where( &#39;start_date &lt;= ?&#39;,  self ).where( &#39;end_date &gt;= ?&#39;,  self ).where( house_id: 2 ).first</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L28' title='View on GitHub'>28</a>   end</code></pre>
<h3>We want to check if this is a parliamentary sitting day in the Commons.</h3>

<p>We use a more strict definition of a sitting day. We don’t include dates for which the Commons continued sitting from a previous day, where the preceding day’s sitting overlapped with the next day’s programmed sitting.</p>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L34' title='View on GitHub'>34</a>   def is_commons_parliamentary_sitting_day?</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L35' title='View on GitHub'>35</a>     SittingDay.all.where( &#39;start_date = ?&#39;,  self ).where( house_id: 1 ).first</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L36' title='View on GitHub'>36</a>   end</code></pre>
<h3>We want to check if this is a parliamentary sitting day in the Lords.</h3>

<p>We use a more strict definition of a sitting day. We don’t include dates for which the Lords continued sitting from a previous day, where the preceding day’s sitting overlapped with the next day’s programmed sitting.</p>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L42' title='View on GitHub'>42</a>   def is_lords_parliamentary_sitting_day?</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L43' title='View on GitHub'>43</a>     SittingDay.all.where( &#39;start_date = ?&#39;,  self ).where( house_id: 2 ).first</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L44' title='View on GitHub'>44</a>   end</code></pre>
<h3>We want to check if this is a virtual sitting day in the Commons.</h3>

<p>This is a day where all Members of the House sit ‘digitally’, rather than physically.</p>

<p>A virtual sitting may continue over more than one calendar day. We count any continuation, where the preceding day’s sitting overlapped with the next day’s programmed sitting, as also being a virtual sitting day.</p>

<p>As of the end of June 2020, the Commons has had no virtual sitting days.</p>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L54' title='View on GitHub'>54</a>   def is_commons_virtual_sitting_day?</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L55' title='View on GitHub'>55</a>     VirtualSittingDay.all.where( &#39;start_date &lt;= ?&#39;,  self ).where( &#39;end_date &gt;= ?&#39;,  self ).where( house_id: 1 ).first</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L56' title='View on GitHub'>56</a>   end</code></pre>
<h3>We want to check if this is a virtual sitting day in the Lords.</h3>

<p>This is a day where all Members of the House sit ‘digitally’, rather than physically.</p>

<p>A virtual sitting may continue over more than one calendar day. We count any continuation, where the preceding day’s sitting overlapped with the next day’s programmed sitting, as also being a virtual sitting day.</p>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L64' title='View on GitHub'>64</a>   def is_lords_virtual_sitting_day?</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L65' title='View on GitHub'>65</a>     VirtualSittingDay.all.where( &#39;start_date &lt;= ?&#39;,  self ).where( &#39;end_date &gt;= ?&#39;,  self ).where( house_id: 2 ).first</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L66' title='View on GitHub'>66</a>   end</code></pre>
<h3>We want to check if this is an actual sitting day in <em>either</em> House.</h3>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L70' title='View on GitHub'>70</a>   def is_either_house_actual_sitting_day?</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L71' title='View on GitHub'>71</a>     self.is_commons_actual_sitting_day? or self.is_lords_actual_sitting_day?</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L72' title='View on GitHub'>72</a>   end</code></pre>
<h3>We want to check if this is an actual sitting day in <em>both</em> Houses.</h3>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L76' title='View on GitHub'>76</a>   def is_joint_actual_sitting_day?</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L77' title='View on GitHub'>77</a>     self.is_commons_actual_sitting_day? and self.is_lords_actual_sitting_day?</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L78' title='View on GitHub'>78</a>   end</code></pre>
<h3>We want to check if this is a parliamentary sitting day in <em>either</em> House.</h3>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L82' title='View on GitHub'>82</a>   def is_either_house_parliamentary_sitting_day?</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L83' title='View on GitHub'>83</a>     self.is_commons_parliamentary_sitting_day? or self.is_lords_parliamentary_sitting_day?</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L84' title='View on GitHub'>84</a>   end</code></pre>
<h3>We want to check if this is a parliamentary sitting day in <em>both</em> Houses.</h3>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L88' title='View on GitHub'>88</a>   def is_joint_parliamentary_sitting_day?</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L89' title='View on GitHub'>89</a>     self.is_commons_parliamentary_sitting_day? and self.is_lords_parliamentary_sitting_day?</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L90' title='View on GitHub'>90</a>   end</code></pre>
<h3>We want to check if this is an adjournment day in either House.</h3>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L94' title='View on GitHub'>94</a>   def is_adjournment_day?</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L95' title='View on GitHub'>95</a>     AdjournmentDay.all.where( &#39;date = ?&#39;,  self ).first</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L96' title='View on GitHub'>96</a>   end</code></pre>
<h3>We want to check if this is an adjournment day in the Commons.</h3>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L100' title='View on GitHub'>100</a>   def is_commons_adjournment_day?</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L101' title='View on GitHub'>101</a>     AdjournmentDay.all.where( &#39;date = ?&#39;,  self ).where( house_id: 1 ).first</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L102' title='View on GitHub'>102</a>   end</code></pre>
<h3>We want to check if this is an adjournment day in the Lords.</h3>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L106' title='View on GitHub'>106</a>   def is_lords_adjournment_day?</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L107' title='View on GitHub'>107</a>     AdjournmentDay.all.where( &#39;date = ?&#39;,  self ).where( house_id: 2 ).first</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L108' title='View on GitHub'>108</a>   end</code></pre>
<h3>We want to check if Parliament is prorogued on this day.</h3>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L112' title='View on GitHub'>112</a>   def is_prorogation_day?</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L113' title='View on GitHub'>113</a>     ProrogationDay.all.where( &#39;date = ?&#39;,  self ).first</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L114' title='View on GitHub'>114</a>   end</code></pre>
<h3>We want to check if Parliament is dissolved on this day.</h3>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L118' title='View on GitHub'>118</a>   def is_dissolution_day?</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L119' title='View on GitHub'>119</a>     DissolutionDay.all.where( &#39;date = ?&#39;,  self ).first</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L120' title='View on GitHub'>120</a>   end</code></pre>
<h3>We want to check if this is a day for which we have something in the calendar.</h3>

<p>That may be an actual sitting day - including parliamentary sitting days, a virtual sitting day, an adjournment day, a day within prorogation or a day within dissolution.</p>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L126' title='View on GitHub'>126</a>   def is_calendar_populated?</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L127' title='View on GitHub'>127</a>     self.is_commons_actual_sitting_day? or self.is_lords_actual_sitting_day? or self.is_commons_virtual_sitting_day? or self.is_lords_virtual_sitting_day? or self.is_adjournment_day? or self.is_prorogation_day? or self.is_dissolution_day?</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L128' title='View on GitHub'>128</a>   end</code></pre>
<h3>We want to check if this is a day for which we do not have anything in the calendar.</h3>

<p>We use this to check if we&#39;ve &quot;run out of calendar&quot; so we don&#39;t keep cycling into future days and loop infinitely.</p>

<p>This is our event horizon.</p>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L136' title='View on GitHub'>136</a>   def is_calendar_not_populated?</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L137' title='View on GitHub'>137</a>     !self.is_calendar_populated?</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L138' title='View on GitHub'>138</a>   end</code></pre>
<h3>Methods to calculate non-sitting scrutiny days in both Houses.</h3>

<p>In <a href="https://committees.parliament.uk/publications/688/documents/33426/default/">guidance issued on 16-04-2020</a> the Lords Procedure Committee stated, &quot;A Virtual Proceeding is not a sitting of the House.&quot;</p>

<p>Whilst clerks state that a virtual sitting day does not count as a sitting day for the purposes of calculating scrutiny periods, lawyers imply this would need to be tested in court.</p>

<p>Unless and until this is resolved, these methods use the clerks&#39; definition of non-sitting scrutiny day.</p>

<h3>We want to check if this is a non-sitting scrutiny day in the Commons.</h3>

<p>During a short adjournment, adjournment days count toward the scrutiny period.</p>

<p>This method allows the definition of a “short” adjournment to be adjusted by passing in a maximum day count.</p>

<p>In all known cases “short” is defined as not more than four days.</p>

<p>For the purposes of calculating non-sitting scrutiny days, virtual sitting days also count.</p>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L158' title='View on GitHub'>158</a>   def is_commons_non_sitting_scrutiny_day?( maximum_day_count )</code></pre>
<h4>We want to check if this is a Commons adjournnment day or a Commons virtual sitting day.</h4>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L162' title='View on GitHub'>162</a>     if self.is_commons_adjournment_day? or self.is_commons_virtual_sitting_day?</code></pre>
<p>Having found that this is a Commons adjournnment day or a Commons virtual sitting day, we start the adjournment day count at 1.</p>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L166' title='View on GitHub'>166</a>       non_sitting_scrutiny_day_count = 1</code></pre>
<p>We want to cycle through the following days until we reach the maximum day count passed into this function.</p>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L170' title='View on GitHub'>170</a>       date = self</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L171' title='View on GitHub'>171</a>       for i in ( 1..maximum_day_count )</code></pre>
<p>Go forward one day.</p>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L175' title='View on GitHub'>175</a>         date = date.next_day</code></pre>
<p>If this is a Commons adjournnment day or a Commons virtual sitting day ...</p>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L178' title='View on GitHub'>178</a>         if date.is_commons_adjournment_day? or date.is_commons_virtual_sitting_day?</code></pre>
<p>... add one to the non-sitting scrutiny day count.</p>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L181' title='View on GitHub'>181</a>           non_sitting_scrutiny_day_count +=1</code></pre>
<p>If this is not a Commons adjournnment day or a Commons virtual sitting day ...</p>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L184' title='View on GitHub'>184</a>         else</code></pre>
<p>... stop cycling through following days.</p>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L187' title='View on GitHub'>187</a>           break</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L188' title='View on GitHub'>188</a>         end</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L189' title='View on GitHub'>189</a>       end</code></pre>
<p>We want to cycle through the preceding days until we reach the maximum day count passed into this function.</p>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L192' title='View on GitHub'>192</a>       date = self</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L193' title='View on GitHub'>193</a>       for i in ( 1..maximum_day_count )</code></pre>
<p>Go back one day.</p>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L196' title='View on GitHub'>196</a>         date = date.prev_day</code></pre>
<p>If this is a Commons adjournnment day or a Commons virtual sitting day ...</p>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L199' title='View on GitHub'>199</a>         if date.is_commons_adjournment_day? or date.is_commons_virtual_sitting_day?</code></pre>
<p>... add one to the non-sitting scrutiny day count.</p>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L202' title='View on GitHub'>202</a>           non_sitting_scrutiny_day_count +=1</code></pre>
<p>If this is not a Commons adjournnment day or a Commons virtual sitting day ...</p>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L205' title='View on GitHub'>205</a>         else</code></pre>
<p>... stop cycling through preceding days.</p>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L208' title='View on GitHub'>208</a>           break</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L209' title='View on GitHub'>209</a>         end</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L210' title='View on GitHub'>210</a>       end</code></pre>
<p>If the total number of continuous non-sitting scrutiny days is more than the maximum day count ...</p>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L213' title='View on GitHub'>213</a>       if non_sitting_scrutiny_day_count &gt; maximum_day_count</code></pre>
<p>... then this day does not count as a non-sitting scrutiny day.</p>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L216' title='View on GitHub'>216</a>         is_commons_non_sitting_scrutiny_day = false</code></pre>
<p>If the total number of continuous non-sitting scrutiny days is less than or the same as the maximum day count ...</p>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L219' title='View on GitHub'>219</a>       else</code></pre>
<p>... then this day does count as a non-sitting scrutiny day.</p>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L222' title='View on GitHub'>222</a>         is_commons_non_sitting_scrutiny_day = true</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L223' title='View on GitHub'>223</a>       end</code></pre>
<p>Returns if this day is a Commons non-sitting scrutiny day</p>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L226' title='View on GitHub'>226</a>       is_commons_non_sitting_scrutiny_day</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L227' title='View on GitHub'>227</a>     end</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L228' title='View on GitHub'>228</a>   end</code></pre>
<h3>We want to check if this is a non-sitting scrutiny day in the Lords.</h3>

<p>During a short adjournment, adjournment days count toward the scrutiny period.</p>

<p>This method allows the definition of a “short” adjournment to be adjusted by passing in a maximum day count.</p>

<p>In all known cases “short” is defined as not more than four days.</p>

<p>For the purposes of calculating non-sitting scrutiny days, virtual sitting days also count.</p>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L240' title='View on GitHub'>240</a>   def is_lords_non_sitting_scrutiny_day?( maximum_day_count )</code></pre>
<h3>We want to check if this is a Lords adjournnment day or a Lords virtual sitting day.</h3>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L244' title='View on GitHub'>244</a>     if self.is_lords_adjournment_day? or self.is_lords_virtual_sitting_day?</code></pre>
<p>Having found that this is a Lords adjournnment day or a Lords virtual sitting day, we start the adjournment day count at 1.</p>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L248' title='View on GitHub'>248</a>       non_sitting_scrutiny_day_count = 1</code></pre>
<p>We want to cycle through the following days until we reach the maximum day count passed into this function.</p>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L252' title='View on GitHub'>252</a>       date = self</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L253' title='View on GitHub'>253</a>       for i in ( 1..maximum_day_count )</code></pre>
<p>Go forward one day.</p>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L257' title='View on GitHub'>257</a>         date = date.next_day</code></pre>
<p>If this is a Lords adjournnment day or a Lords virtual sitting day ...</p>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L260' title='View on GitHub'>260</a>         if date.is_lords_adjournment_day? or date.is_lords_virtual_sitting_day?</code></pre>
<p>... add one to the non-sitting scrutiny day count.</p>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L263' title='View on GitHub'>263</a>           non_sitting_scrutiny_day_count +=1</code></pre>
<p>If this is not a Lords adjournnment day or a Lords virtual sitting day ...</p>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L266' title='View on GitHub'>266</a>         else</code></pre>
<p>... stop cycling through following days.</p>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L269' title='View on GitHub'>269</a>           break</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L270' title='View on GitHub'>270</a>         end</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L271' title='View on GitHub'>271</a>       end</code></pre>
<p>We want to cycle through the preceding days until we reach the maximum day count passed into this function.</p>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L274' title='View on GitHub'>274</a>       date = self</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L275' title='View on GitHub'>275</a>       for i in ( 1..maximum_day_count )</code></pre>
<p>Go back one day.</p>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L278' title='View on GitHub'>278</a>         date = date.prev_day</code></pre>
<p>If this is a Lords adjournnment day or a Lords virtual sitting day ...</p>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L281' title='View on GitHub'>281</a>         if date.is_lords_adjournment_day? or date.is_lords_virtual_sitting_day?</code></pre>
<p>... add one to the non-sitting scrutiny day count.</p>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L284' title='View on GitHub'>284</a>           non_sitting_scrutiny_day_count +=1</code></pre>
<p>If this is not a Lords adjournnment day or a Lords virtual sitting day ...</p>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L287' title='View on GitHub'>287</a>         else</code></pre>
<p>... stop cycling through preceding days.</p>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L290' title='View on GitHub'>290</a>           break</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L291' title='View on GitHub'>291</a>         end</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L292' title='View on GitHub'>292</a>       end</code></pre>
<p>If the total number of continuous non-sitting scrutiny days is more than the maximum day count ...</p>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L295' title='View on GitHub'>295</a>       if non_sitting_scrutiny_day_count &gt; maximum_day_count</code></pre>
<p>... then this day does not count as a non-sitting scrutiny day.</p>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L298' title='View on GitHub'>298</a>         is_lords_non_sitting_scrutiny_day = false</code></pre>
<p>If the total number of continuous non-sitting scrutiny days is less than or the same as the maximum day count ...</p>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L301' title='View on GitHub'>301</a>       else</code></pre>
<p>... then this day does count as a non-sitting scrutiny day.</p>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L304' title='View on GitHub'>304</a>         is_lords_non_sitting_scrutiny_day = true</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L305' title='View on GitHub'>305</a>       end</code></pre>
<p>Returns if this day is a Lords non-sitting scrutiny day</p>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L308' title='View on GitHub'>308</a>       is_lords_non_sitting_scrutiny_day</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L309' title='View on GitHub'>309</a>     end</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L310' title='View on GitHub'>310</a>   end</code></pre>
<p>(End of methods to calculate non-sitting scrutiny days in both Houses.)</p>

<h3>We want to check if this is a scrutiny day in the Commons.</h3>

<p>A scrutiny day in the Commons is either an actual sitting day in the Commons, or a non-sitting scrutiny day in the Commons.</p>

<p>We pass &#39;4&#39; as the maximum day count to the non-sitting scrutiny day calculation, because non-sitting scrutiny days are days within a series of not more than four non-sitting days.</p>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L320' title='View on GitHub'>320</a>   def is_commons_scrutiny_day?</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L321' title='View on GitHub'>321</a>     self.is_commons_actual_sitting_day? or self.is_commons_non_sitting_scrutiny_day?( 4 )</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L322' title='View on GitHub'>322</a>   end</code></pre>
<h3>We want to check if this is a scrutiny day in the Lords.</h3>

<p>A scrutiny day in the Lords is either an actual sitting day in the Lords, or a non-sitting scrutiny day in the Lords.</p>

<p>We pass &#39;4&#39; as the maximum day count to the non-sitting scrutiny day calculation, because  non-sitting scrutiny days are days within a series of not more than four non-sitting days.</p>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L330' title='View on GitHub'>330</a>   def is_lords_scrutiny_day?</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L331' title='View on GitHub'>331</a>     self.is_lords_actual_sitting_day? or self.is_lords_non_sitting_scrutiny_day?( 4 )</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L332' title='View on GitHub'>332</a>   end</code></pre>
<h3>We want to check if this is a scrutiny day in <em>either</em> House.</h3>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L336' title='View on GitHub'>336</a>   def is_either_house_scrutiny_day?</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L337' title='View on GitHub'>337</a>     self.is_commons_scrutiny_day? or self.is_lords_scrutiny_day?</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L338' title='View on GitHub'>338</a>   end</code></pre>
<h3>We want to check if this is a scrutiny day in <em>both</em> Houses.</h3>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L342' title='View on GitHub'>342</a>   def is_joint_scrutiny_day?</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L343' title='View on GitHub'>343</a>     self.is_commons_scrutiny_day? and self.is_lords_scrutiny_day?</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L344' title='View on GitHub'>344</a>   end</code></pre>
<p>(End of set of methods to work out the type of a given day.)</p>

<h2>A set of methods to find the first day of a given type.</h2>

<h3>We want to find the first scrutiny day in <em>either</em> House.</h3>

<p>This method is used when a Statutory Instrument is laid outside of a scrutiny period, that is: during a non-sitting period of more than four days, or during a period in which Parliament is prorogued. In such cases, the clock starts from the first actual sitting day in either House following the laying.</p>

<p>This method is used for bicameral negative SIs - and bicameral made affirmatives where the enabling legislation specifies that either House can be sitting.</p>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L357' title='View on GitHub'>357</a>   def first_scrutiny_day_in_either_house</code></pre>
<p>If this is a day on which the calendar is not yet populated ...</p>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L360' title='View on GitHub'>360</a>     if self.is_calendar_not_populated?</code></pre>
<p>... then we cannot find a first scrutiny day so we stop looking.</p>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L363' title='View on GitHub'>363</a>       return nil</code></pre>
<p>If this is a day on which the calendar is populated ...</p>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L366' title='View on GitHub'>366</a>     else</code></pre>
<p>... then if this is not a scrutiny day in <em>either</em> House ...</p>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L369' title='View on GitHub'>369</a>       unless self.is_either_house_scrutiny_day?</code></pre>
<p>... then go to the next day and check that.</p>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L372' title='View on GitHub'>372</a>         self.next_day.first_scrutiny_day_in_either_house</code></pre>
<p>... then if this is a scrutiny day in either House ...</p>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L375' title='View on GitHub'>375</a>       else</code></pre>
<p>... then return this day as the first scrutiny day in either House.</p>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L378' title='View on GitHub'>378</a>         self</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L379' title='View on GitHub'>379</a>       end</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L380' title='View on GitHub'>380</a>     end</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L381' title='View on GitHub'>381</a>   end</code></pre>
<h3>We want to find the first scrutiny day in <em>both</em> Houses.</h3>

<p>This method is used when a Statutory Instrument is laid outside of a scrutiny period, that is: during an adjournment of more than four days, or during a period in which Parliament is prorogued. The clock starts from the first actual sitting day in both Houses following the laying.</p>

<p>This method is used for bicameral made affirmatives where the enabling legislation specifies that both Houses must be sitting.</p>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L389' title='View on GitHub'>389</a>   def first_joint_scrutiny_day</code></pre>
<p>If this is a day on which the calendar is not yet populated ...</p>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L392' title='View on GitHub'>392</a>     if self.is_calendar_not_populated?</code></pre>
<p>... then we cannot find a first scrutiny day so we stop looking.</p>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L395' title='View on GitHub'>395</a>       return nil</code></pre>
<p>If this is a day on which the calendar is populated ...</p>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L398' title='View on GitHub'>398</a>     else</code></pre>
<p>... then if this is not a scrutiny day in both Houses ...</p>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L401' title='View on GitHub'>401</a>       unless self.is_joint_scrutiny_day?</code></pre>
<p>... then go to the next day and check that.</p>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L404' title='View on GitHub'>404</a>         self.next_day.first_joint_scrutiny_day</code></pre>
<p>... then if this is a scrutiny day in both Houses ...</p>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L407' title='View on GitHub'>407</a>       else</code></pre>
<p>... then return this day as the first scrutiny day in both Houses.</p>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L410' title='View on GitHub'>410</a>         self</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L411' title='View on GitHub'>411</a>       end</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L412' title='View on GitHub'>412</a>     end</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L413' title='View on GitHub'>413</a>   end</code></pre>
<h3>We want to find the first scrutiny day in the Commons.</h3>

<p>This method is used when a Statutory Instrument is laid outside of a scrutiny period, that is: during an adjournment of more than four days, or during a period in which Parliament is prorogued. The clock starts from the first actual sitting day in the Commons following the laying.</p>

<p>This method is used for negative or made affirmative SIs - laid in the Commons and not laid in the Lords.</p>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L421' title='View on GitHub'>421</a>   def first_commons_scrutiny_day</code></pre>
<p>If this is a day on which the calendar is not yet populated ...</p>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L424' title='View on GitHub'>424</a>     if self.is_calendar_not_populated?</code></pre>
<p>... then we cannot find a first Commons scrutiny day so we stop looking.</p>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L427' title='View on GitHub'>427</a>       return nil</code></pre>
<p>If this is a day on which the calendar is populated ...</p>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L430' title='View on GitHub'>430</a>     else</code></pre>
<p>... then if this is not a scrutiny day in the Commons ...</p>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L433' title='View on GitHub'>433</a>       unless self.is_commons_scrutiny_day?</code></pre>
<p>... then go to the next day and check that.</p>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L436' title='View on GitHub'>436</a>         self.next_day.first_commons_scrutiny_day</code></pre>
<p>... then if this is a scrutiny day in the Commons ...</p>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L439' title='View on GitHub'>439</a>       else</code></pre>
<p>... then return this day as the first scrutiny day in the Commons.</p>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L442' title='View on GitHub'>442</a>         self</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L443' title='View on GitHub'>443</a>       end</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L444' title='View on GitHub'>444</a>     end</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L445' title='View on GitHub'>445</a>   end</code></pre>
<h3>We want to find the first parliamentary sitting day in both Houses.</h3>

<p>This method is used when a Proposed Negative Statutory Instrument is laid.</p>

<p>Even if a PNSI is laid on a joint parliamentary sitting day, the clock does not start until the next joint parliamentary sitting day.</p>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L453' title='View on GitHub'>453</a>   def first_joint_parliamentary_sitting_day</code></pre>
<p>If this is a day on which the calendar is not yet populated ...</p>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L456' title='View on GitHub'>456</a>     if self.is_calendar_not_populated?</code></pre>
<p>... then we cannot find a first parliamentary sitting day in both Houses so we stop looking.</p>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L459' title='View on GitHub'>459</a>       return nil</code></pre>
<p>If this is a day on which the calendar is populated ...</p>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L462' title='View on GitHub'>462</a>     else</code></pre>
<p>... then if this is not a parliamentary sitting day in both Houses ...</p>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L465' title='View on GitHub'>465</a>       unless self.is_joint_parliamentary_sitting_day?</code></pre>
<p>... then go to the next day and check that.</p>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L468' title='View on GitHub'>468</a>         self.next_day.first_joint_parliamentary_sitting_day</code></pre>
<p>... then if this is a parliamentary sitting day in both Houses ...</p>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L471' title='View on GitHub'>471</a>       else</code></pre>
<p>... then return this day as the first parliamentary sitting day in both Houses.</p>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L474' title='View on GitHub'>474</a>         self</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L475' title='View on GitHub'>475</a>       end</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L476' title='View on GitHub'>476</a>     end</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L477' title='View on GitHub'>477</a>   end</code></pre>
<h3>We want to find the first actual sitting day in both Houses.</h3>

<p>This method is used to calculate periods A and B for treaties.</p>

<p>Even if a treaty is laid or a ministerial statement is made on a joint actual sitting day, the clock does not start until the next joint actual sitting day.</p>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L485' title='View on GitHub'>485</a>   def first_joint_actual_sitting_day</code></pre>
<p>If this is a day on which the calendar is not yet populated ...</p>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L488' title='View on GitHub'>488</a>     if self.is_calendar_not_populated?</code></pre>
<p>... then we cannot find a first actual sitting day in both Houses so we stop looking.</p>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L491' title='View on GitHub'>491</a>       return nil</code></pre>
<p>If this is a day on which the calendar is populated ...</p>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L494' title='View on GitHub'>494</a>     else</code></pre>
<p>... then if this is not an actual sitting day in both Houses ...</p>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L497' title='View on GitHub'>497</a>       unless self.is_joint_actual_sitting_day?</code></pre>
<p>... then go to the next day and check that.</p>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L500' title='View on GitHub'>500</a>         self.next_day.first_joint_actual_sitting_day</code></pre>
<p>... then if this is an actual sitting day in both Houses ...</p>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L503' title='View on GitHub'>503</a>       else</code></pre>
<p>... then return this day as the first actual sitting day in both Houses.</p>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L506' title='View on GitHub'>506</a>         self</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L507' title='View on GitHub'>507</a>       end</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L508' title='View on GitHub'>508</a>     end</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L509' title='View on GitHub'>509</a>   end</code></pre>
<h3>We want to find the first actual sitting day in the House of Commons.</h3>

<p>This method is used by the House of Commons only sitting day calculation.</p>

<p>Even if an instrument is laid on a House of Commons actual sitting day, the clock does not start until the next House of Commons actual sitting day.</p>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L517' title='View on GitHub'>517</a>   def first_commons_actual_sitting_day</code></pre>
<p>If this is a day on which the calendar is not yet populated ...</p>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L520' title='View on GitHub'>520</a>     if self.is_calendar_not_populated?</code></pre>
<p>... then we cannot find a first actual sitting day in the House of Commons so we stop looking.</p>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L523' title='View on GitHub'>523</a>       return nil</code></pre>
<p>If this is a day on which the calendar is populated ...</p>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L526' title='View on GitHub'>526</a>     else</code></pre>
<p>... then if this is not an actual sitting day in the House of Commons ...</p>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L529' title='View on GitHub'>529</a>       unless self.is_commons_actual_sitting_day?</code></pre>
<p>... then go to the next day and check that.</p>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L532' title='View on GitHub'>532</a>         self.next_day.first_commons_actual_sitting_day</code></pre>
<p>... then if this is an actual sitting day in the House of Commons ...</p>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L535' title='View on GitHub'>535</a>       else</code></pre>
<p>... then return this day as the first actual sitting day in the House of Commons.</p>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L538' title='View on GitHub'>538</a>         self</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L539' title='View on GitHub'>539</a>       end</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L540' title='View on GitHub'>540</a>     end</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L541' title='View on GitHub'>541</a>   end</code></pre>
<p>(End of set of methods to find the first day of a given type.)</p>

<h2>A set of methods to return which higher level parliamentary time periods a calendar day sits in.</h2>

<p>A calendar day may sit in either a dissolution period or a Parliament period.</p>

<p>If a calendar day sits inside a Parliament period, it may sit inside either a session or a prorogation period.</p>

<h3>We want to find which dissolution period a calendar day sits in, if any.</h3>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L555' title='View on GitHub'>555</a>   def dissolution_period</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L556' title='View on GitHub'>556</a>     DissolutionPeriod.all.where( &quot;start_date &lt;= ?&quot;, self ).where( &quot;end_date &gt;= ?&quot;, self).first</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L557' title='View on GitHub'>557</a>   end</code></pre>
<h3>We want to find which Parliament period a calendar day sits in, if any.</h3>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L560' title='View on GitHub'>560</a>   def parliament_period</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L561' title='View on GitHub'>561</a>     ParliamentPeriod.find_by_sql([</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L562' title='View on GitHub'>562</a>       &quot;</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L563' title='View on GitHub'>563</a>         SELECT *</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L564' title='View on GitHub'>564</a>         FROM parliament_periods</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L565' title='View on GitHub'>565</a>         WHERE start_date &lt;= :the_date</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L566' title='View on GitHub'>566</a>         AND (</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L567' title='View on GitHub'>567</a>           end_date &gt;= :the_date</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L568' title='View on GitHub'>568</a>           OR</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L569' title='View on GitHub'>569</a>           end_date IS NULL</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L570' title='View on GitHub'>570</a>         )</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L571' title='View on GitHub'>571</a>       &quot;,</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L572' title='View on GitHub'>572</a>       the_date: self</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L573' title='View on GitHub'>573</a>     ]).first</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L574' title='View on GitHub'>574</a>   end</code></pre>
<h3>We want to find which prorogoration period a calendar day sits in, if any.</h3>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L577' title='View on GitHub'>577</a>   def prorogation_period</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L578' title='View on GitHub'>578</a>     ProrogationPeriod.all.where( &quot;start_date &lt;= ?&quot;, self ).where( &quot;end_date &gt;= ?&quot;, self).first</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L579' title='View on GitHub'>579</a>   end</code></pre>
<h3>We want to find which session a calendar day sits in, if any.</h3>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L582' title='View on GitHub'>582</a>   def session</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L583' title='View on GitHub'>583</a>     Session.find_by_sql([</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L584' title='View on GitHub'>584</a>       &quot;</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L585' title='View on GitHub'>585</a>         SELECT *</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L586' title='View on GitHub'>586</a>         FROM sessions</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L587' title='View on GitHub'>587</a>         WHERE start_date &lt;= :the_date</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L588' title='View on GitHub'>588</a>         AND (</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L589' title='View on GitHub'>589</a>           end_date &gt;= :the_date</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L590' title='View on GitHub'>590</a>           OR</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L591' title='View on GitHub'>591</a>           end_date IS NULL</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L592' title='View on GitHub'>592</a>         )</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L593' title='View on GitHub'>593</a>       &quot;,</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L594' title='View on GitHub'>594</a>       the_date: self</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L595' title='View on GitHub'>595</a>     ]).first</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L596' title='View on GitHub'>596</a>   end</code></pre>
<h2>We want to find out if this is the final day of a session.</h2>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L599' title='View on GitHub'>599</a>   def is_final_day_of_session?</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L600' title='View on GitHub'>600</a>     is_final_day_of_session = false</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L601' title='View on GitHub'>601</a>     session = Session.all.where( &quot;end_date = ?&quot;, self )</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L602' title='View on GitHub'>602</a>     is_final_day_of_session = true unless session.empty?</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L603' title='View on GitHub'>603</a>     is_final_day_of_session</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L604' title='View on GitHub'>604</a>   end</code></pre>
<h2>We want to find the session immediately preceding this date.</h2>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L608' title='View on GitHub'>608</a>   def preceding_session</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L609' title='View on GitHub'>609</a>     Session.all.where( &quot;start_date &lt; ?&quot;, self ).order( &quot;start_date DESC&quot; ).first</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L610' title='View on GitHub'>610</a>   end</code></pre>
<h2>We want to find the session immediately following this date.</h2>

<p>This method is used to determine which session papers laid in prorogation are recorded in.</p>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L614' title='View on GitHub'>614</a>   def following_session</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L615' title='View on GitHub'>615</a>     Session.all.where( &quot;start_date &gt; ?&quot;, self ).order( &quot;start_date&quot; ).first</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L616' title='View on GitHub'>616</a>   end</code></pre>
<h3>Generate label for the day type in the Commons in a session.</h3>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L619' title='View on GitHub'>619</a>   def commons_day_type</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L620' title='View on GitHub'>620</a>     if self.is_commons_parliamentary_sitting_day?</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L621' title='View on GitHub'>621</a>       day_type = &#39;Parliamentary sitting day&#39;</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L622' title='View on GitHub'>622</a>     elsif self.is_commons_actual_sitting_day?</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L623' title='View on GitHub'>623</a>       day_type = &quot;Continuation sitting day&quot;</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L624' title='View on GitHub'>624</a>     elsif self.is_commons_virtual_sitting_day?</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L625' title='View on GitHub'>625</a>       day_type = &#39;Virtual sitting day&#39;</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L626' title='View on GitHub'>626</a>     elsif self.is_commons_non_sitting_scrutiny_day?( 4 )</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L627' title='View on GitHub'>627</a>       day_type = &#39;Scrutiny non-sitting day&#39;</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L628' title='View on GitHub'>628</a>     elsif self.is_commons_adjournment_day?</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L629' title='View on GitHub'>629</a>       day_type = self.commons_adjournment_day_label</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L630' title='View on GitHub'>630</a>     elsif self.session</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L631' title='View on GitHub'>631</a>       day_type = &#39;Session day of unknown type&#39;</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L632' title='View on GitHub'>632</a>     elsif self.is_prorogation_day?</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L633' title='View on GitHub'>633</a>       day_type = &#39;Prorogation&#39;</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L634' title='View on GitHub'>634</a>     elsif self.is_dissolution_day?</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L635' title='View on GitHub'>635</a>       day_type = &#39;Dissolution&#39;</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L636' title='View on GitHub'>636</a>     end</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L637' title='View on GitHub'>637</a>     day_type</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L638' title='View on GitHub'>638</a>   end</code></pre>
<h3>Generate label for the day type in the Lords in a session.</h3>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L641' title='View on GitHub'>641</a>   def lords_day_type</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L642' title='View on GitHub'>642</a>     if self.is_lords_parliamentary_sitting_day?</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L643' title='View on GitHub'>643</a>       day_type = &#39;Parliamentary sitting day&#39;</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L644' title='View on GitHub'>644</a>     elsif self.is_lords_actual_sitting_day?</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L645' title='View on GitHub'>645</a>       day_type = &quot;Continuation sitting day&quot;</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L646' title='View on GitHub'>646</a>     elsif self.is_lords_virtual_sitting_day?</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L647' title='View on GitHub'>647</a>       day_type = &#39;Virtual sitting day&#39;</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L648' title='View on GitHub'>648</a>     elsif self.is_lords_non_sitting_scrutiny_day?( 4 )</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L649' title='View on GitHub'>649</a>       day_type = &#39;Scrutiny non-sitting day&#39;</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L650' title='View on GitHub'>650</a>     elsif self.is_lords_adjournment_day?</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L651' title='View on GitHub'>651</a>       day_type = self.lords_adjournment_day_label</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L652' title='View on GitHub'>652</a>     elsif self.session</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L653' title='View on GitHub'>653</a>       day_type = &#39;Session day of unknown type&#39;</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L654' title='View on GitHub'>654</a>     elsif self.is_prorogation_day?</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L655' title='View on GitHub'>655</a>       day_type = &#39;Prorogation&#39;</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L656' title='View on GitHub'>656</a>     elsif self.is_dissolution_day?</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L657' title='View on GitHub'>657</a>       day_type = &#39;Dissolution&#39;</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L658' title='View on GitHub'>658</a>     end</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L659' title='View on GitHub'>659</a>     day_type</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L660' title='View on GitHub'>660</a>   end</code></pre>
<h3>Generate a label to say whether it&#39;s a scrutiny day in the Commons or not.</h3>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L663' title='View on GitHub'>663</a>   def is_commons_scrutiny_day_label</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L664' title='View on GitHub'>664</a>     if self.is_commons_scrutiny_day?</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L665' title='View on GitHub'>665</a>       label = &#39;True&#39;</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L666' title='View on GitHub'>666</a>     else</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L667' title='View on GitHub'>667</a>       label = &#39;False&#39;</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L668' title='View on GitHub'>668</a>     end</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L669' title='View on GitHub'>669</a>     label</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L670' title='View on GitHub'>670</a>   end</code></pre>
<h3>Generate a label to say whether it&#39;s a scrutiny day in the Lords or not.</h3>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L673' title='View on GitHub'>673</a>   def is_lords_scrutiny_day_label</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L674' title='View on GitHub'>674</a>     if self.is_lords_scrutiny_day?</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L675' title='View on GitHub'>675</a>       label = &#39;True&#39;</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L676' title='View on GitHub'>676</a>     else</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L677' title='View on GitHub'>677</a>       label = &#39;False&#39;</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L678' title='View on GitHub'>678</a>     end</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L679' title='View on GitHub'>679</a>     label</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L680' title='View on GitHub'>680</a>   end</code></pre>
<h3>A method to label a Commons adjournment day, with recess if applicable.</h3>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L683' title='View on GitHub'>683</a>   def commons_adjournment_day_label</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L684' title='View on GitHub'>684</a>     commons_adjournment_day_label = &#39;Adjournment day&#39;</code></pre>
<p>We attempt to find a recess on this date, in this House.</p>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L687' title='View on GitHub'>687</a>     recess_date = RecessDate</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L688' title='View on GitHub'>688</a>       .all</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L689' title='View on GitHub'>689</a>       .where( &quot;start_date &lt;= ?&quot;, self )</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L690' title='View on GitHub'>690</a>       .where( &quot;end_date &gt;= ?&quot;, self )</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L691' title='View on GitHub'>691</a>       .where( house_id: 1 )</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L692' title='View on GitHub'>692</a>       .first</code></pre>
<p>If we find a recess date on this day, in this House ...</p>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L695' title='View on GitHub'>695</a>     if recess_date</code></pre>
<p>... we append the description of the recess date to the label</p>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L698' title='View on GitHub'>698</a>       commons_adjournment_day_label += &#39; (&#39; + recess_date.description + &#39;)&#39;</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L699' title='View on GitHub'>699</a>     end</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L700' title='View on GitHub'>700</a>     commons_adjournment_day_label</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L701' title='View on GitHub'>701</a>   end</code></pre>
<h3>A method to label a Lords adjournment day, with recess if applicable.</h3>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L704' title='View on GitHub'>704</a>   def lords_adjournment_day_label</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L705' title='View on GitHub'>705</a>     lords_adjournment_day_label = &#39;Adjournment day&#39;</code></pre>
<p>We attempt to find a recess on this date, in this House.</p>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L708' title='View on GitHub'>708</a>     recess_date = RecessDate</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L709' title='View on GitHub'>709</a>       .all</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L710' title='View on GitHub'>710</a>       .where( &quot;start_date &lt;= ?&quot;, self )</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L711' title='View on GitHub'>711</a>       .where( &quot;end_date &gt;= ?&quot;, self )</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L712' title='View on GitHub'>712</a>       .where( house_id: 2 )</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L713' title='View on GitHub'>713</a>       .first</code></pre>
<p>If we find a recess date on this day, in this House ...</p>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L716' title='View on GitHub'>716</a>     if recess_date</code></pre>
<p>... we append the description of the recess date to the label</p>

<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L719' title='View on GitHub'>719</a>       lords_adjournment_day_label += &#39; (&#39; + recess_date.description + &#39;)&#39;</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L720' title='View on GitHub'>720</a>     end</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L721' title='View on GitHub'>721</a>     lords_adjournment_day_label</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L722' title='View on GitHub'>722</a>   end</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L723' title='View on GitHub'>723</a> end</code></pre>
<pre><code><a href='https://github.com/ukparliament/egg-timer/blob/main/config/initializers/monkey_patching.rb#L725' title='View on GitHub'>725</a> Date.include(DateMonkeyPatch)</code></pre>
  </main>
  
  <footer>
    <p>This page was generated at 2025-06-10 17:08:45.</p>
  </footer>
</body>
</html>
